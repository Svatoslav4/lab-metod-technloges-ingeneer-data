# ====== –õ–ê–ë–û–†–ê–¢–û–†–ù–ê –†–û–ë–û–¢–ê: –ê–ù–ê–õ–Ü–ó –ü–†–û–î–ê–ñ–Ü–í (–£–∫—Ä–∞—ó–Ω—Å—å–∫—ñ –Ω–∞–∑–≤–∏ –∫–æ–ª–æ–Ω–æ–∫) ======
import pandas as pd

# 1Ô∏è‚É£ –ó—á–∏—Ç—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
df = pd.read_csv('data_BI_ukr.csv', encoding='utf-8-sig')
print("–ü–µ—Ä—à—ñ 5 —Ä—è–¥–∫—ñ–≤ –¥–∞–Ω–∏—Ö:")
print(df.head())

# 2Ô∏è‚É£ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –¥–∞–Ω—ñ
print("\n–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –¥–∞–Ω—ñ:")
df.info()
print("\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–ª—è —á–∏—Å–ª–æ–≤–∏—Ö –∫–æ–ª–æ–Ω–æ–∫:")
print(df.describe())
print("\n–ù–∞–∑–≤–∏ –∫–æ–ª–æ–Ω–æ–∫:")
print(df.columns)

# 3Ô∏è‚É£ –î–æ–¥–∞–º–æ –∫–æ–ª–æ–Ω–∫—É Total –¥–ª—è —Å—É–º–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤
df['Total'] = df['–ö—ñ–ª—å–∫—ñ—Å—Ç—å'] * df['–¶—ñ–Ω–∞_–∑–∞_–æ–¥–∏–Ω–∏—Ü—é']

# –ü–µ—Ä–µ—Ç–≤–æ—Ä–∏–º–æ –∫–æ–ª–æ–Ω–∫—É –¥–∞—Ç–∏
df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'] = pd.to_datetime(df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'])

# ====== –ê–ù–ê–õ–Ü–ó –ü–ò–¢–ê–ù–ù–Ø 1-12 ======

# 1Ô∏è‚É£ –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑–∞ –≤–µ—Å—å –ø–µ—Ä—ñ–æ–¥
print("\n1Ô∏è‚É£ –ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –ø—Ä–æ–¥–∞–∂—ñ–≤:")
total_sales = df['Total'].sum()
print("–ó–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –ø—Ä–æ–¥–∞–∂—ñ–≤:", total_sales)

# 2Ô∏è‚É£ –°—É–º–∞ –ø—Ä–æ–¥–∞–∂—ñ–≤ –ø–æ —Ä–æ–∫–∞—Ö
print("\n2Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –ø–æ —Ä–æ–∫–∞—Ö:")
for year in df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'].dt.year.unique():
    sales_year = df[df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'].dt.year == year]['Total'].sum()
    print(f"–†—ñ–∫ {year}: {sales_year}")

# 3Ô∏è‚É£ –ù–∞–π–ø—Ä–∏–±—É—Ç–∫–æ–≤—ñ—à–∏–π –º—ñ—Å—è—Ü—å
print("\n3Ô∏è‚É£ –ù–∞–π–ø—Ä–∏–±—É—Ç–∫–æ–≤—ñ—à–∏–π –º—ñ—Å—è—Ü—å:")
monthly_income = df.groupby(df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'].dt.to_period('M'))['Total'].sum()
print(monthly_income)
print("–ù–∞–π–ø—Ä–∏–±—É—Ç–∫–æ–≤—ñ—à–∏–π –º—ñ—Å—è—Ü—å:", monthly_income.idxmax(), "—Å—É–º–∞:", monthly_income.max())

# 4Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –ø–æ —Ä–µ–≥—ñ–æ–Ω–∞—Ö
print("\n4Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –ø–æ —Ä–µ–≥—ñ–æ–Ω–∞—Ö:")
region_sales = df.groupby('–†–µ–≥—ñ–æ–Ω')['Total'].sum()
print(region_sales)

# 5Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞—Ö
print("\n5Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞—Ö:")
store_sales = df.groupby('–ú–∞–≥–∞–∑–∏–Ω')['Total'].sum()
print(store_sales)

# 6Ô∏è‚É£ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä–æ–±–æ—á—ñ vs –≤–∏—Ö—ñ–¥–Ω—ñ –¥–Ω—ñ
print("\n6Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ: —Ä–æ–±–æ—á—ñ vs –≤–∏—Ö—ñ–¥–Ω—ñ –¥–Ω—ñ:")
df['–î–µ–Ω—å_—Ç–∏–∂–Ω—è'] = df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'].dt.weekday
workday_sales = df[df['–î–µ–Ω—å_—Ç–∏–∂–Ω—è'] < 5]['Total'].sum()
weekend_sales = df[df['–î–µ–Ω—å_—Ç–∏–∂–Ω—è'] >= 5]['Total'].sum()
print(f"–†–æ–±–æ—á—ñ –¥–Ω—ñ: {workday_sales}, –í–∏—Ö—ñ–¥–Ω—ñ –¥–Ω—ñ: {weekend_sales}")

# 7Ô∏è‚É£ –°–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞—Ö
print("\n7Ô∏è‚É£ –°–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫ –ø–æ –º–∞–≥–∞–∑–∏–Ω–∞—Ö:")
avg_per_store = df.groupby('–ú–∞–≥–∞–∑–∏–Ω')['Total'].mean()
print(avg_per_store)

# 8Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä—É
product_name = '–¢–æ–≤–∞—Ä_–ê'  # –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞ –ø–æ—Ç—Ä—ñ–±–Ω–∏–π —Ç–æ–≤–∞—Ä
print(f"\n8Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ —Ç–æ–≤–∞—Ä—É {product_name}:")
product_sales = df[df['–¢–æ–≤–∞—Ä'] == product_name]['Total'].sum()
print(product_sales)

# 9Ô∏è‚É£ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω—å –ø–æ –º—ñ—Å—è—Ü—è—Ö
print("\n9Ô∏è‚É£ –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω—å –ø–æ –º—ñ—Å—è—Ü—è—Ö:")
orders_per_month = df.groupby(df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'].dt.to_period('M'))['ID_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'].count()
print(orders_per_month)

# üîü –ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π —Ç–æ–≤–∞—Ä (–∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é)
print("\nüîü –ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π —Ç–æ–≤–∞—Ä –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é:")
popular_product = df.groupby('–¢–æ–≤–∞—Ä')['–ö—ñ–ª—å–∫—ñ—Å—Ç—å'].sum().sort_values(ascending=False)
print(popular_product.head(1))

# 1Ô∏è‚É£1Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –∑–∞ –ø–µ–≤–Ω–∏–π –ø–µ—Ä—ñ–æ–¥
start_date = '2023-01-01'
end_date = '2023-03-31'
print(f"\n1Ô∏è‚É£1Ô∏è‚É£ –ü—Ä–æ–¥–∞–∂—ñ –∑ {start_date} –ø–æ {end_date}:")
period_sales = df[(df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'] >= start_date) & (df['–î–∞—Ç–∞_–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è'] <= end_date)]['Total'].sum()
print(period_sales)

# 1Ô∏è‚É£2Ô∏è‚É£ –°–µ—Ä–µ–¥–Ω—ñ–π –¥–æ—Ö—ñ–¥ –Ω–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑–∞ –∫–æ–∂–µ–Ω –¥–µ–Ω—å —Ç–∏–∂–Ω—è
print("\n1Ô∏è‚É£2Ô∏è‚É£ –°–µ—Ä–µ–¥–Ω—ñ–π –¥–æ—Ö—ñ–¥ –Ω–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑–∞ –¥–Ω—ñ —Ç–∏–∂–Ω—è:")
avg_per_weekday = df.groupby(df['–î–µ–Ω—å_—Ç–∏–∂–Ω—è'])['Total'].mean()
print(avg_per_weekday)
